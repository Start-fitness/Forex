{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.keepStreamAlive = exports.userEventHandler = void 0;\n\nvar _lodash = _interopRequireDefault(require(\"lodash.zipobject\"));\n\nvar _httpClient = _interopRequireDefault(require(\"./http-client\"));\n\nvar _openWebsocket = _interopRequireDefault(require(\"./open-websocket\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\n\nfunction _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) {\n    return;\n  }\n\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nvar endpoints = {\n  base: 'wss://stream.binance.com:9443/ws',\n  futures: 'wss://fstream.binance.com/ws'\n};\n\nvar depthTransform = function depthTransform(m) {\n  return {\n    eventType: m.e,\n    eventTime: m.E,\n    symbol: m.s,\n    firstUpdateId: m.U,\n    finalUpdateId: m.u,\n    bidDepth: m.b.map(function (b) {\n      return (0, _lodash.default)(['price', 'quantity'], b);\n    }),\n    askDepth: m.a.map(function (a) {\n      return (0, _lodash.default)(['price', 'quantity'], a);\n    })\n  };\n};\n\nvar futuresDepthTransform = function futuresDepthTransform(m) {\n  return {\n    eventType: m.e,\n    eventTime: m.E,\n    transactionTime: m.T,\n    symbol: m.s,\n    firstUpdateId: m.U,\n    finalUpdateId: m.u,\n    prevFinalUpdateId: m.pu,\n    bidDepth: m.b.map(function (b) {\n      return (0, _lodash.default)(['price', 'quantity'], b);\n    }),\n    askDepth: m.a.map(function (a) {\n      return (0, _lodash.default)(['price', 'quantity'], a);\n    })\n  };\n};\n\nvar depth = function depth(payload, cb) {\n  var transform = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n  var variator = arguments.length > 3 ? arguments[3] : undefined;\n  var cache = (Array.isArray(payload) ? payload : [payload]).map(function (symbol) {\n    var _symbol$toLowerCase$s = symbol.toLowerCase().split('@'),\n        _symbol$toLowerCase$s2 = _slicedToArray(_symbol$toLowerCase$s, 2),\n        symbolName = _symbol$toLowerCase$s2[0],\n        updateSpeed = _symbol$toLowerCase$s2[1];\n\n    var w = (0, _openWebsocket.default)(\"\".concat(variator === 'futures' ? endpoints.futures : endpoints.base, \"/\").concat(symbolName, \"@depth\").concat(updateSpeed ? \"@\".concat(updateSpeed) : ''));\n\n    w.onmessage = function (msg) {\n      var obj = JSON.parse(msg.data);\n      cb(transform ? variator === 'futures' ? futuresDepthTransform(obj) : depthTransform(obj) : obj);\n    };\n\n    return w;\n  });\n  return function (options) {\n    return cache.forEach(function (w) {\n      return w.close(1000, 'Close handle was called', _objectSpread({\n        keepClosed: true\n      }, options));\n    });\n  };\n};\n\nvar partialDepthTransform = function partialDepthTransform(symbol, level, m) {\n  return {\n    symbol: symbol,\n    level: level,\n    lastUpdateId: m.lastUpdateId,\n    bids: m.bids.map(function (b) {\n      return (0, _lodash.default)(['price', 'quantity'], b);\n    }),\n    asks: m.asks.map(function (a) {\n      return (0, _lodash.default)(['price', 'quantity'], a);\n    })\n  };\n};\n\nvar futuresPartDepthTransform = function futuresPartDepthTransform(level, m) {\n  return {\n    level: level,\n    eventType: m.e,\n    eventTime: m.E,\n    transactionTime: m.T,\n    symbol: m.s,\n    firstUpdateId: m.U,\n    finalUpdateId: m.u,\n    prevFinalUpdateId: m.pu,\n    bidDepth: m.b.map(function (b) {\n      return (0, _lodash.default)(['price', 'quantity'], b);\n    }),\n    askDepth: m.a.map(function (a) {\n      return (0, _lodash.default)(['price', 'quantity'], a);\n    })\n  };\n};\n\nvar partialDepth = function partialDepth(payload, cb) {\n  var transform = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n  var variator = arguments.length > 3 ? arguments[3] : undefined;\n  var cache = (Array.isArray(payload) ? payload : [payload]).map(function (_ref) {\n    var symbol = _ref.symbol,\n        level = _ref.level;\n\n    var _symbol$toLowerCase$s3 = symbol.toLowerCase().split('@'),\n        _symbol$toLowerCase$s4 = _slicedToArray(_symbol$toLowerCase$s3, 2),\n        symbolName = _symbol$toLowerCase$s4[0],\n        updateSpeed = _symbol$toLowerCase$s4[1];\n\n    var w = (0, _openWebsocket.default)(\"\".concat(variator === 'futures' ? endpoints.futures : endpoints.base, \"/\").concat(symbolName, \"@depth\").concat(level).concat(updateSpeed ? \"@\".concat(updateSpeed) : ''));\n\n    w.onmessage = function (msg) {\n      var obj = JSON.parse(msg.data);\n      cb(transform ? variator === 'futures' ? futuresPartDepthTransform(level, obj) : partialDepthTransform(symbol, level, obj) : obj);\n    };\n\n    return w;\n  });\n  return function (options) {\n    return cache.forEach(function (w) {\n      return w.close(1000, 'Close handle was called', _objectSpread({\n        keepClosed: true\n      }, options));\n    });\n  };\n};\n\nvar candles = function candles(payload, interval, cb) {\n  var transform = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;\n  var variator = arguments.length > 4 ? arguments[4] : undefined;\n\n  if (!interval || !cb) {\n    throw new Error('Please pass a symbol, interval and callback.');\n  }\n\n  var cache = (Array.isArray(payload) ? payload : [payload]).map(function (symbol) {\n    var w = (0, _openWebsocket.default)(\"\".concat(variator === 'futures' ? endpoints.futures : endpoints.base, \"/\").concat(symbol.toLowerCase(), \"@kline_\").concat(interval));\n\n    w.onmessage = function (msg) {\n      var obj = JSON.parse(msg.data);\n      var eventType = obj.e,\n          eventTime = obj.E,\n          symbol = obj.s,\n          tick = obj.k;\n      var startTime = tick.t,\n          closeTime = tick.T,\n          firstTradeId = tick.f,\n          lastTradeId = tick.L,\n          open = tick.o,\n          high = tick.h,\n          low = tick.l,\n          close = tick.c,\n          volume = tick.v,\n          trades = tick.n,\n          interval = tick.i,\n          isFinal = tick.x,\n          quoteVolume = tick.q,\n          buyVolume = tick.V,\n          quoteBuyVolume = tick.Q;\n      cb(transform ? {\n        eventType: eventType,\n        eventTime: eventTime,\n        symbol: symbol,\n        startTime: startTime,\n        closeTime: closeTime,\n        firstTradeId: firstTradeId,\n        lastTradeId: lastTradeId,\n        open: open,\n        high: high,\n        low: low,\n        close: close,\n        volume: volume,\n        trades: trades,\n        interval: interval,\n        isFinal: isFinal,\n        quoteVolume: quoteVolume,\n        buyVolume: buyVolume,\n        quoteBuyVolume: quoteBuyVolume\n      } : obj);\n    };\n\n    return w;\n  });\n  return function (options) {\n    return cache.forEach(function (w) {\n      return w.close(1000, 'Close handle was called', _objectSpread({\n        keepClosed: true\n      }, options));\n    });\n  };\n};\n\nvar miniTickerTransform = function miniTickerTransform(m) {\n  return {\n    eventType: m.e,\n    eventTime: m.E,\n    symbol: m.s,\n    curDayClose: m.c,\n    open: m.o,\n    high: m.h,\n    low: m.l,\n    volume: m.v,\n    volumeQuote: m.q\n  };\n};\n\nvar tickerTransform = function tickerTransform(m) {\n  return {\n    eventType: m.e,\n    eventTime: m.E,\n    symbol: m.s,\n    priceChange: m.p,\n    priceChangePercent: m.P,\n    weightedAvg: m.w,\n    prevDayClose: m.x,\n    curDayClose: m.c,\n    closeTradeQuantity: m.Q,\n    bestBid: m.b,\n    bestBidQnt: m.B,\n    bestAsk: m.a,\n    bestAskQnt: m.A,\n    open: m.o,\n    high: m.h,\n    low: m.l,\n    volume: m.v,\n    volumeQuote: m.q,\n    openTime: m.O,\n    closeTime: m.C,\n    firstTradeId: m.F,\n    lastTradeId: m.L,\n    totalTrades: m.n\n  };\n};\n\nvar futuresTickerTransform = function futuresTickerTransform(m) {\n  return {\n    eventType: m.e,\n    eventTime: m.E,\n    symbol: m.s,\n    priceChange: m.p,\n    priceChangePercent: m.P,\n    weightedAvg: m.w,\n    curDayClose: m.c,\n    closeTradeQuantity: m.Q,\n    open: m.o,\n    high: m.h,\n    low: m.l,\n    volume: m.v,\n    volumeQuote: m.q,\n    openTime: m.O,\n    closeTime: m.C,\n    firstTradeId: m.F,\n    lastTradeId: m.L,\n    totalTrades: m.n\n  };\n};\n\nvar ticker = function ticker(payload, cb) {\n  var transform = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n  var variator = arguments.length > 3 ? arguments[3] : undefined;\n  var cache = (Array.isArray(payload) ? payload : [payload]).map(function (symbol) {\n    var w = (0, _openWebsocket.default)(\"\".concat(variator === 'futures' ? endpoints.futures : endpoints.base, \"/\").concat(symbol.toLowerCase(), \"@ticker\"));\n\n    w.onmessage = function (msg) {\n      var obj = JSON.parse(msg.data);\n      cb(transform ? variator === 'futures' ? futuresTickerTransform(obj) : tickerTransform(obj) : obj);\n    };\n\n    return w;\n  });\n  return function (options) {\n    return cache.forEach(function (w) {\n      return w.close(1000, 'Close handle was called', _objectSpread({\n        keepClosed: true\n      }, options));\n    });\n  };\n};\n\nvar allTickers = function allTickers(cb) {\n  var transform = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n  var variator = arguments.length > 2 ? arguments[2] : undefined;\n  var w = new _openWebsocket.default(\"\".concat(variator === 'futures' ? endpoints.futures : endpoints.base, \"/!ticker@arr\"));\n\n  w.onmessage = function (msg) {\n    var arr = JSON.parse(msg.data);\n    cb(transform ? variator === 'futures' ? arr.map(function (m) {\n      return futuresTickerTransform(m);\n    }) : arr.map(function (m) {\n      return tickerTransform(m);\n    }) : arr);\n  };\n\n  return function (options) {\n    return w.close(1000, 'Close handle was called', _objectSpread({\n      keepClosed: true\n    }, options));\n  };\n};\n\nvar miniTicker = function miniTicker(payload, cb) {\n  var transform = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n  var cache = (Array.isArray(payload) ? payload : [payload]).map(function (symbol) {\n    var w = (0, _openWebsocket.default)(\"\".concat(endpoints.base, \"/\").concat(symbol.toLowerCase(), \"@miniTicker\"));\n\n    w.onmessage = function (msg) {\n      var obj = JSON.parse(msg.data);\n      cb(transform ? miniTickerTransform(obj) : obj);\n    };\n\n    return w;\n  });\n  return function (options) {\n    return cache.forEach(function (w) {\n      return w.close(1000, 'Close handle was called', _objectSpread({\n        keepClosed: true\n      }, options));\n    });\n  };\n};\n\nvar allMiniTicker = function allMiniTicker(payload, cb) {\n  var transform = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n  var cache = (Array.isArray(payload) ? payload : [payload]).map(function (symbol) {\n    var w = (0, _openWebsocket.default)(\"\".concat(endpoints.base, \"/!miniTicker@arr\"));\n\n    w.onmessage = function (msg) {\n      var arr = JSON.parse(msg.data);\n      cb(transform ? arr.map(function (m) {\n        return miniTickerTransform(m);\n      }) : arr);\n    };\n\n    return w;\n  });\n  return function (options) {\n    return cache.forEach(function (w) {\n      return w.close(1000, 'Close handle was called', _objectSpread({\n        keepClosed: true\n      }, options));\n    });\n  };\n};\n\nvar customSubStream = function customSubStream(payload, cb, variator) {\n  var cache = (Array.isArray(payload) ? payload : [payload]).map(function (sub) {\n    var w = (0, _openWebsocket.default)(\"\".concat(variator === 'futures' ? endpoints.futures : endpoints.base, \"/\").concat(sub));\n\n    w.onmessage = function (msg) {\n      var data = JSON.parse(msg.data);\n      cb(data);\n    };\n\n    return w;\n  });\n  return function (options) {\n    return cache.forEach(function (w) {\n      return w.close(1000, 'Close handle was called', _objectSpread({\n        keepClosed: true\n      }, options));\n    });\n  };\n};\n\nvar aggTradesTransform = function aggTradesTransform(m) {\n  return {\n    eventType: m.e,\n    eventTime: m.E,\n    timestamp: m.T,\n    symbol: m.s,\n    price: m.p,\n    quantity: m.q,\n    isBuyerMaker: m.m,\n    wasBestPrice: m.M,\n    aggId: m.a,\n    firstId: m.f,\n    lastId: m.l\n  };\n};\n\nvar futuresAggTradesTransform = function futuresAggTradesTransform(m) {\n  return {\n    eventType: m.e,\n    eventTime: m.E,\n    symbol: m.s,\n    aggId: m.a,\n    price: m.p,\n    quantity: m.q,\n    firstId: m.f,\n    lastId: m.l,\n    timestamp: m.T,\n    isBuyerMaker: m.m\n  };\n};\n\nvar aggTrades = function aggTrades(payload, cb) {\n  var transform = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n  var variator = arguments.length > 3 ? arguments[3] : undefined;\n  var cache = (Array.isArray(payload) ? payload : [payload]).map(function (symbol) {\n    var w = (0, _openWebsocket.default)(\"\".concat(variator === 'futures' ? endpoints.futures : endpoints.base, \"/\").concat(symbol.toLowerCase(), \"@aggTrade\"));\n\n    w.onmessage = function (msg) {\n      var obj = JSON.parse(msg.data);\n      cb(transform ? variator === 'futures' ? futuresAggTradesTransform(obj) : aggTradesTransform(obj) : obj);\n    };\n\n    return w;\n  });\n  return function (options) {\n    return cache.forEach(function (w) {\n      return w.close(1000, 'Close handle was called', _objectSpread({\n        keepClosed: true\n      }, options));\n    });\n  };\n};\n\nvar futuresLiqsTransform = function futuresLiqsTransform(m) {\n  return {\n    symbol: m.s,\n    price: m.p,\n    origQty: m.q,\n    lastFilledQty: m.l,\n    accumulatedQty: m.z,\n    averagePrice: m.ap,\n    status: m.X,\n    timeInForce: m.f,\n    type: m.o,\n    side: m.S,\n    time: m.T\n  };\n};\n\nvar futuresLiquidations = function futuresLiquidations(payload, cb) {\n  var transform = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n  var cache = (Array.isArray(payload) ? payload : [payload]).map(function (symbol) {\n    var w = (0, _openWebsocket.default)(\"\".concat(endpoints.futures, \"/\").concat(symbol.toLowerCase(), \"@forceOrder\"));\n\n    w.onmessage = function (msg) {\n      var obj = JSON.parse(msg.data);\n      cb(transform ? futuresLiqsTransform(obj.o) : obj);\n    };\n\n    return w;\n  });\n  return function (options) {\n    return cache.forEach(function (w) {\n      return w.close(1000, 'Close handle was called', _objectSpread({\n        keepClosed: true\n      }, options));\n    });\n  };\n};\n\nvar futuresAllLiquidations = function futuresAllLiquidations(cb) {\n  var transform = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n  var w = new _openWebsocket.default(\"\".concat(endpoints.futures, \"/!forceOrder@arr\"));\n\n  w.onmessage = function (msg) {\n    var obj = JSON.parse(msg.data);\n    cb(transform ? futuresLiqsTransform(obj.o) : obj);\n  };\n\n  return function (options) {\n    return w.close(1000, 'Close handle was called', _objectSpread({\n      keepClosed: true\n    }, options));\n  };\n};\n\nvar tradesTransform = function tradesTransform(m) {\n  return {\n    eventType: m.e,\n    eventTime: m.E,\n    tradeTime: m.T,\n    symbol: m.s,\n    price: m.p,\n    quantity: m.q,\n    isBuyerMaker: m.m,\n    maker: m.M,\n    tradeId: m.t,\n    buyerOrderId: m.b,\n    sellerOrderId: m.a\n  };\n};\n\nvar trades = function trades(payload, cb) {\n  var transform = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n  var cache = (Array.isArray(payload) ? payload : [payload]).map(function (symbol) {\n    var w = (0, _openWebsocket.default)(\"\".concat(endpoints.base, \"/\").concat(symbol.toLowerCase(), \"@trade\"));\n\n    w.onmessage = function (msg) {\n      var obj = JSON.parse(msg.data);\n      cb(transform ? tradesTransform(obj) : obj);\n    };\n\n    return w;\n  });\n  return function (options) {\n    return cache.forEach(function (w) {\n      return w.close(1000, 'Close handle was called', _objectSpread({\n        keepClosed: true\n      }, options));\n    });\n  };\n};\n\nvar userTransforms = {\n  // https://github.com/binance-exchange/binance-official-api-docs/blob/master/user-data-stream.md#balance-update\n  balanceUpdate: function balanceUpdate(m) {\n    return {\n      asset: m.a,\n      balanceDelta: m.d,\n      clearTime: m.T,\n      eventTime: m.E,\n      eventType: 'balanceUpdate'\n    };\n  },\n  // https://github.com/binance-exchange/binance-official-api-docs/blob/master/user-data-stream.md#account-update\n  outboundAccountInfo: function outboundAccountInfo(m) {\n    return {\n      eventType: 'account',\n      eventTime: m.E,\n      makerCommissionRate: m.m,\n      takerCommissionRate: m.t,\n      buyerCommissionRate: m.b,\n      sellerCommissionRate: m.s,\n      canTrade: m.T,\n      canWithdraw: m.W,\n      canDeposit: m.D,\n      lastAccountUpdate: m.u,\n      balances: m.B.reduce(function (out, cur) {\n        out[cur.a] = {\n          available: cur.f,\n          locked: cur.l\n        };\n        return out;\n      }, {})\n    };\n  },\n  // https://github.com/binance-exchange/binance-official-api-docs/blob/master/user-data-stream.md#account-update\n  outboundAccountPosition: function outboundAccountPosition(m) {\n    return {\n      balances: m.B.map(function (_ref2) {\n        var a = _ref2.a,\n            f = _ref2.f,\n            l = _ref2.l;\n        return {\n          asset: a,\n          free: f,\n          locked: l\n        };\n      }),\n      eventTime: m.E,\n      eventType: 'outboundAccountPosition',\n      lastAccountUpdate: m.u\n    };\n  },\n  // https://github.com/binance-exchange/binance-official-api-docs/blob/master/user-data-stream.md#order-update\n  executionReport: function executionReport(m) {\n    return {\n      eventType: 'executionReport',\n      eventTime: m.E,\n      symbol: m.s,\n      newClientOrderId: m.c,\n      originalClientOrderId: m.C,\n      side: m.S,\n      orderType: m.o,\n      timeInForce: m.f,\n      quantity: m.q,\n      price: m.p,\n      executionType: m.x,\n      stopPrice: m.P,\n      icebergQuantity: m.F,\n      orderStatus: m.X,\n      orderRejectReason: m.r,\n      orderId: m.i,\n      orderTime: m.T,\n      lastTradeQuantity: m.l,\n      totalTradeQuantity: m.z,\n      priceLastTrade: m.L,\n      commission: m.n,\n      commissionAsset: m.N,\n      tradeId: m.t,\n      isOrderWorking: m.w,\n      isBuyerMaker: m.m,\n      creationTime: m.O,\n      totalQuoteTradeQuantity: m.Z,\n      orderListId: m.g,\n      quoteOrderQuantity: m.Q,\n      lastQuoteTransacted: m.Y\n    };\n  }\n};\nvar futuresUserTransforms = {\n  // https://binance-docs.github.io/apidocs/futures/en/#event-margin-call\n  MARGIN_CALL: function MARGIN_CALL(m) {\n    return {\n      eventTime: m.E,\n      crossWalletBalance: m.cw,\n      eventType: 'MARGIN_CALL',\n      positions: m.p.reduce(function (out, cur) {\n        out[cur.a] = {\n          symbol: cur.s,\n          positionSide: cur.ps,\n          positionAmount: cur.pa,\n          marginType: cur.mt,\n          isolatedWallet: cur.iw,\n          markPrice: cur.mp,\n          unrealizedPnL: cur.up,\n          maintenanceMarginRequired: cur.mm\n        };\n        return out;\n      }, {})\n    };\n  },\n  // https://binance-docs.github.io/apidocs/futures/en/#event-balance-and-position-update\n  ACCOUNT_UPDATE: function ACCOUNT_UPDATE(m) {\n    return {\n      eventTime: m.E,\n      transactionTime: m.T,\n      eventType: 'ACCOUNT_UPDATE',\n      eventReasonType: m.a.m,\n      balances: m.a.B.map(function (b) {\n        return {\n          asset: b.a,\n          walletBalance: b.wb,\n          crossWalletBalance: b.cw,\n          balanceChange: b.bc\n        };\n      }),\n      positions: m.a.P.map(function (p) {\n        return {\n          symbol: p.s,\n          positionAmount: p.pa,\n          entryPrice: p.ep,\n          accumulatedRealized: p.cr,\n          unrealizedPnL: p.up,\n          marginType: p.mt,\n          isolatedWallet: p.iw,\n          positionSide: p.ps\n        };\n      })\n    };\n  },\n  // https://binance-docs.github.io/apidocs/futures/en/#event-order-update\n  ORDER_TRADE_UPDATE: function ORDER_TRADE_UPDATE(m) {\n    return {\n      eventType: 'ORDER_TRADE_UPDATE',\n      eventTime: m.E,\n      transactionTime: m.T,\n      symbol: m.o.s,\n      clientOrderId: m.o.c,\n      side: m.o.S,\n      orderType: m.o.o,\n      timeInForce: m.o.f,\n      quantity: m.o.q,\n      price: m.o.p,\n      averagePrice: m.o.ap,\n      stopPrice: m.o.sp,\n      executionType: m.o.x,\n      orderStatus: m.o.X,\n      orderId: m.o.i,\n      lastTradeQuantity: m.o.l,\n      totalTradeQuantity: m.o.z,\n      priceLastTrade: m.o.L,\n      commissionAsset: m.o.N,\n      commission: m.o.n,\n      orderTime: m.o.T,\n      tradeId: m.o.t,\n      bidsNotional: m.o.b,\n      asksNotional: m.o.a,\n      isMaker: m.o.m,\n      isReduceOnly: m.o.R,\n      workingType: m.o.wt,\n      originalOrderType: m.o.ot,\n      positionSide: m.o.ps,\n      closePosition: m.o.cp,\n      activationPrice: m.o.AP,\n      callbackRate: m.o.cr,\n      realizedProfit: m.o.rp\n    };\n  }\n};\n\nvar userEventHandler = function userEventHandler(cb) {\n  var transform = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n  var variator = arguments.length > 2 ? arguments[2] : undefined;\n  return function (msg) {\n    var _JSON$parse = JSON.parse(msg.data),\n        type = _JSON$parse.e,\n        rest = _objectWithoutProperties(_JSON$parse, [\"e\"]);\n\n    cb(variator === 'futures' ? transform && futuresUserTransforms[type] ? futuresUserTransforms[type](rest) : _objectSpread({\n      type: type\n    }, rest) : transform && userTransforms[type] ? userTransforms[type](rest) : _objectSpread({\n      type: type\n    }, rest));\n  };\n};\n\nexports.userEventHandler = userEventHandler;\nvar STREAM_METHODS = ['get', 'keep', 'close'];\n\nvar capitalize = function capitalize(str, check) {\n  return check ? \"\".concat(str[0].toUpperCase()).concat(str.slice(1)) : str;\n};\n\nvar getStreamMethods = function getStreamMethods(opts) {\n  var variator = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n  var methods = (0, _httpClient.default)(opts);\n  return STREAM_METHODS.reduce(function (acc, key) {\n    return [].concat(_toConsumableArray(acc), [methods[\"\".concat(variator).concat(capitalize(\"\".concat(key, \"DataStream\"), !!variator))]]);\n  }, []);\n};\n\nvar keepStreamAlive = function keepStreamAlive(method, listenKey) {\n  return method({\n    listenKey: listenKey\n  });\n};\n\nexports.keepStreamAlive = keepStreamAlive;\n\nvar user = function user(opts, variator) {\n  return function (cb, transform) {\n    var _getStreamMethods = getStreamMethods(opts, variator),\n        _getStreamMethods2 = _slicedToArray(_getStreamMethods, 3),\n        getDataStream = _getStreamMethods2[0],\n        keepDataStream = _getStreamMethods2[1],\n        closeDataStream = _getStreamMethods2[2];\n\n    var currentListenKey = null;\n    var int = null;\n    var w = null;\n\n    var keepAlive = function keepAlive(isReconnecting) {\n      if (currentListenKey) {\n        keepStreamAlive(keepDataStream, currentListenKey).catch(function () {\n          closeStream({}, true);\n\n          if (isReconnecting) {\n            setTimeout(function () {\n              return makeStream(true);\n            }, 30e3);\n          } else {\n            makeStream(true);\n          }\n        });\n      }\n    };\n\n    var closeStream = function closeStream(options, catchErrors) {\n      if (currentListenKey) {\n        clearInterval(int);\n        var p = closeDataStream({\n          listenKey: currentListenKey\n        });\n\n        if (catchErrors) {\n          p.catch(function (f) {\n            return f;\n          });\n        }\n\n        w.close(1000, 'Close handle was called', _objectSpread({\n          keepClosed: true\n        }, options));\n        currentListenKey = null;\n      }\n    };\n\n    var makeStream = function makeStream(isReconnecting) {\n      return getDataStream().then(function (_ref3) {\n        var listenKey = _ref3.listenKey;\n        w = (0, _openWebsocket.default)(\"\".concat(variator === 'futures' ? endpoints.futures : endpoints.base, \"/\").concat(listenKey));\n\n        w.onmessage = function (msg) {\n          return userEventHandler(cb, transform, variator)(msg);\n        };\n\n        currentListenKey = listenKey;\n        int = setInterval(function () {\n          return keepAlive(false);\n        }, 50e3);\n        keepAlive(true);\n        return function (options) {\n          return closeStream(options);\n        };\n      }).catch(function (err) {\n        if (isReconnecting) {\n          setTimeout(function () {\n            return makeStream(true);\n          }, 30e3);\n        } else {\n          throw err;\n        }\n      });\n    };\n\n    return makeStream(false);\n  };\n};\n\nvar _default = function _default(opts) {\n  if (opts && opts.wsBase) {\n    endpoints.base = opts.wsBase;\n  }\n\n  if (opts && opts.wsFutures) {\n    endpoints.futures = opts.wsFutures;\n  }\n\n  return {\n    depth: depth,\n    partialDepth: partialDepth,\n    candles: candles,\n    trades: trades,\n    aggTrades: aggTrades,\n    ticker: ticker,\n    allTickers: allTickers,\n    miniTicker: miniTicker,\n    allMiniTicker: allMiniTicker,\n    customSubStream: customSubStream,\n    user: user(opts),\n    marginUser: user(opts, 'margin'),\n    futuresDepth: function futuresDepth(payload, cb, transform) {\n      return depth(payload, cb, transform, 'futures');\n    },\n    futuresPartialDepth: function futuresPartialDepth(payload, cb, transform) {\n      return partialDepth(payload, cb, transform, 'futures');\n    },\n    futuresCandles: function futuresCandles(payload, interval, cb, transform) {\n      return candles(payload, interval, cb, transform, 'futures');\n    },\n    futuresTicker: function futuresTicker(payload, cb, transform) {\n      return ticker(payload, cb, transform, 'futures');\n    },\n    futuresAllTickers: function futuresAllTickers(cb, transform) {\n      return allTickers(cb, transform, 'futures');\n    },\n    futuresAggTrades: function futuresAggTrades(payload, cb, transform) {\n      return aggTrades(payload, cb, transform, 'futures');\n    },\n    futuresLiquidations: futuresLiquidations,\n    futuresAllLiquidations: futuresAllLiquidations,\n    futuresUser: user(opts, 'futures'),\n    futuresCustomSubStream: function futuresCustomSubStream(payload, cb) {\n      return customSubStream(payload, cb, 'futures');\n    }\n  };\n};\n\nexports.default = _default;","map":{"version":3,"sources":["E:/temporary_project/Forex/Forex/node_modules/binance-api-node/dist/websocket.js"],"names":["Object","defineProperty","exports","value","default","keepStreamAlive","userEventHandler","_lodash","_interopRequireDefault","require","_httpClient","_openWebsocket","obj","__esModule","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_nonIterableSpread","TypeError","iter","Symbol","iterator","prototype","toString","call","Array","from","isArray","i","arr2","length","_objectWithoutProperties","source","excluded","target","_objectWithoutPropertiesLoose","key","getOwnPropertySymbols","sourceSymbolKeys","indexOf","propertyIsEnumerable","sourceKeys","keys","ownKeys","object","enumerableOnly","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","configurable","writable","_slicedToArray","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","_arr","_n","_d","_e","undefined","_i","_s","next","done","err","endpoints","base","futures","depthTransform","m","eventType","e","eventTime","E","symbol","s","firstUpdateId","U","finalUpdateId","u","bidDepth","b","map","askDepth","a","futuresDepthTransform","transactionTime","T","prevFinalUpdateId","pu","depth","payload","cb","transform","variator","cache","_symbol$toLowerCase$s","toLowerCase","split","_symbol$toLowerCase$s2","symbolName","updateSpeed","w","concat","onmessage","msg","JSON","parse","data","options","close","keepClosed","partialDepthTransform","level","lastUpdateId","bids","asks","futuresPartDepthTransform","partialDepth","_ref","_symbol$toLowerCase$s3","_symbol$toLowerCase$s4","candles","interval","Error","tick","k","startTime","t","closeTime","firstTradeId","f","lastTradeId","L","open","o","high","h","low","l","c","volume","v","trades","n","isFinal","x","quoteVolume","q","buyVolume","V","quoteBuyVolume","Q","miniTickerTransform","curDayClose","volumeQuote","tickerTransform","priceChange","p","priceChangePercent","P","weightedAvg","prevDayClose","closeTradeQuantity","bestBid","bestBidQnt","B","bestAsk","bestAskQnt","A","openTime","O","C","F","totalTrades","futuresTickerTransform","ticker","allTickers","miniTicker","allMiniTicker","customSubStream","sub","aggTradesTransform","timestamp","price","quantity","isBuyerMaker","wasBestPrice","M","aggId","firstId","lastId","futuresAggTradesTransform","aggTrades","futuresLiqsTransform","origQty","lastFilledQty","accumulatedQty","z","averagePrice","ap","status","X","timeInForce","type","side","S","time","futuresLiquidations","futuresAllLiquidations","tradesTransform","tradeTime","maker","tradeId","buyerOrderId","sellerOrderId","userTransforms","balanceUpdate","asset","balanceDelta","d","clearTime","outboundAccountInfo","makerCommissionRate","takerCommissionRate","buyerCommissionRate","sellerCommissionRate","canTrade","canWithdraw","W","canDeposit","D","lastAccountUpdate","balances","reduce","out","cur","available","locked","outboundAccountPosition","_ref2","free","executionReport","newClientOrderId","originalClientOrderId","orderType","executionType","stopPrice","icebergQuantity","orderStatus","orderRejectReason","r","orderId","orderTime","lastTradeQuantity","totalTradeQuantity","priceLastTrade","commission","commissionAsset","N","isOrderWorking","creationTime","totalQuoteTradeQuantity","Z","orderListId","g","quoteOrderQuantity","lastQuoteTransacted","Y","futuresUserTransforms","MARGIN_CALL","crossWalletBalance","cw","positions","positionSide","ps","positionAmount","pa","marginType","mt","isolatedWallet","iw","markPrice","mp","unrealizedPnL","up","maintenanceMarginRequired","mm","ACCOUNT_UPDATE","eventReasonType","walletBalance","wb","balanceChange","bc","entryPrice","ep","accumulatedRealized","cr","ORDER_TRADE_UPDATE","clientOrderId","sp","bidsNotional","asksNotional","isMaker","isReduceOnly","R","workingType","wt","originalOrderType","ot","closePosition","cp","activationPrice","AP","callbackRate","realizedProfit","rp","_JSON$parse","rest","STREAM_METHODS","capitalize","str","check","toUpperCase","slice","getStreamMethods","opts","methods","acc","method","listenKey","user","_getStreamMethods","_getStreamMethods2","getDataStream","keepDataStream","closeDataStream","currentListenKey","int","keepAlive","isReconnecting","catch","closeStream","setTimeout","makeStream","catchErrors","clearInterval","then","_ref3","setInterval","_default","wsBase","wsFutures","marginUser","futuresDepth","futuresPartialDepth","futuresCandles","futuresTicker","futuresAllTickers","futuresAggTrades","futuresUser","futuresCustomSubStream"],"mappings":"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","sourcesContent":["\"use strict\";\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n  value: true\r\n});\r\nexports.default = exports.keepStreamAlive = exports.userEventHandler = void 0;\r\n\r\nvar _lodash = _interopRequireDefault(require(\"lodash.zipobject\"));\r\n\r\nvar _httpClient = _interopRequireDefault(require(\"./http-client\"));\r\n\r\nvar _openWebsocket = _interopRequireDefault(require(\"./open-websocket\"));\r\n\r\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\r\n\r\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }\r\n\r\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance\"); }\r\n\r\nfunction _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter); }\r\n\r\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }\r\n\r\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\r\n\r\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\r\n\r\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\r\n\r\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\r\n\r\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\r\n\r\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\r\n\r\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\r\n\r\nfunction _iterableToArrayLimit(arr, i) { if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) { return; } var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\r\n\r\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\r\n\r\nvar endpoints = {\r\n  base: 'wss://stream.binance.com:9443/ws',\r\n  futures: 'wss://fstream.binance.com/ws'\r\n};\r\n\r\nvar depthTransform = function depthTransform(m) {\r\n  return {\r\n    eventType: m.e,\r\n    eventTime: m.E,\r\n    symbol: m.s,\r\n    firstUpdateId: m.U,\r\n    finalUpdateId: m.u,\r\n    bidDepth: m.b.map(function (b) {\r\n      return (0, _lodash.default)(['price', 'quantity'], b);\r\n    }),\r\n    askDepth: m.a.map(function (a) {\r\n      return (0, _lodash.default)(['price', 'quantity'], a);\r\n    })\r\n  };\r\n};\r\n\r\nvar futuresDepthTransform = function futuresDepthTransform(m) {\r\n  return {\r\n    eventType: m.e,\r\n    eventTime: m.E,\r\n    transactionTime: m.T,\r\n    symbol: m.s,\r\n    firstUpdateId: m.U,\r\n    finalUpdateId: m.u,\r\n    prevFinalUpdateId: m.pu,\r\n    bidDepth: m.b.map(function (b) {\r\n      return (0, _lodash.default)(['price', 'quantity'], b);\r\n    }),\r\n    askDepth: m.a.map(function (a) {\r\n      return (0, _lodash.default)(['price', 'quantity'], a);\r\n    })\r\n  };\r\n};\r\n\r\nvar depth = function depth(payload, cb) {\r\n  var transform = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\r\n  var variator = arguments.length > 3 ? arguments[3] : undefined;\r\n  var cache = (Array.isArray(payload) ? payload : [payload]).map(function (symbol) {\r\n    var _symbol$toLowerCase$s = symbol.toLowerCase().split('@'),\r\n        _symbol$toLowerCase$s2 = _slicedToArray(_symbol$toLowerCase$s, 2),\r\n        symbolName = _symbol$toLowerCase$s2[0],\r\n        updateSpeed = _symbol$toLowerCase$s2[1];\r\n\r\n    var w = (0, _openWebsocket.default)(\"\".concat(variator === 'futures' ? endpoints.futures : endpoints.base, \"/\").concat(symbolName, \"@depth\").concat(updateSpeed ? \"@\".concat(updateSpeed) : ''));\r\n\r\n    w.onmessage = function (msg) {\r\n      var obj = JSON.parse(msg.data);\r\n      cb(transform ? variator === 'futures' ? futuresDepthTransform(obj) : depthTransform(obj) : obj);\r\n    };\r\n\r\n    return w;\r\n  });\r\n  return function (options) {\r\n    return cache.forEach(function (w) {\r\n      return w.close(1000, 'Close handle was called', _objectSpread({\r\n        keepClosed: true\r\n      }, options));\r\n    });\r\n  };\r\n};\r\n\r\nvar partialDepthTransform = function partialDepthTransform(symbol, level, m) {\r\n  return {\r\n    symbol: symbol,\r\n    level: level,\r\n    lastUpdateId: m.lastUpdateId,\r\n    bids: m.bids.map(function (b) {\r\n      return (0, _lodash.default)(['price', 'quantity'], b);\r\n    }),\r\n    asks: m.asks.map(function (a) {\r\n      return (0, _lodash.default)(['price', 'quantity'], a);\r\n    })\r\n  };\r\n};\r\n\r\nvar futuresPartDepthTransform = function futuresPartDepthTransform(level, m) {\r\n  return {\r\n    level: level,\r\n    eventType: m.e,\r\n    eventTime: m.E,\r\n    transactionTime: m.T,\r\n    symbol: m.s,\r\n    firstUpdateId: m.U,\r\n    finalUpdateId: m.u,\r\n    prevFinalUpdateId: m.pu,\r\n    bidDepth: m.b.map(function (b) {\r\n      return (0, _lodash.default)(['price', 'quantity'], b);\r\n    }),\r\n    askDepth: m.a.map(function (a) {\r\n      return (0, _lodash.default)(['price', 'quantity'], a);\r\n    })\r\n  };\r\n};\r\n\r\nvar partialDepth = function partialDepth(payload, cb) {\r\n  var transform = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\r\n  var variator = arguments.length > 3 ? arguments[3] : undefined;\r\n  var cache = (Array.isArray(payload) ? payload : [payload]).map(function (_ref) {\r\n    var symbol = _ref.symbol,\r\n        level = _ref.level;\r\n\r\n    var _symbol$toLowerCase$s3 = symbol.toLowerCase().split('@'),\r\n        _symbol$toLowerCase$s4 = _slicedToArray(_symbol$toLowerCase$s3, 2),\r\n        symbolName = _symbol$toLowerCase$s4[0],\r\n        updateSpeed = _symbol$toLowerCase$s4[1];\r\n\r\n    var w = (0, _openWebsocket.default)(\"\".concat(variator === 'futures' ? endpoints.futures : endpoints.base, \"/\").concat(symbolName, \"@depth\").concat(level).concat(updateSpeed ? \"@\".concat(updateSpeed) : ''));\r\n\r\n    w.onmessage = function (msg) {\r\n      var obj = JSON.parse(msg.data);\r\n      cb(transform ? variator === 'futures' ? futuresPartDepthTransform(level, obj) : partialDepthTransform(symbol, level, obj) : obj);\r\n    };\r\n\r\n    return w;\r\n  });\r\n  return function (options) {\r\n    return cache.forEach(function (w) {\r\n      return w.close(1000, 'Close handle was called', _objectSpread({\r\n        keepClosed: true\r\n      }, options));\r\n    });\r\n  };\r\n};\r\n\r\nvar candles = function candles(payload, interval, cb) {\r\n  var transform = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;\r\n  var variator = arguments.length > 4 ? arguments[4] : undefined;\r\n\r\n  if (!interval || !cb) {\r\n    throw new Error('Please pass a symbol, interval and callback.');\r\n  }\r\n\r\n  var cache = (Array.isArray(payload) ? payload : [payload]).map(function (symbol) {\r\n    var w = (0, _openWebsocket.default)(\"\".concat(variator === 'futures' ? endpoints.futures : endpoints.base, \"/\").concat(symbol.toLowerCase(), \"@kline_\").concat(interval));\r\n\r\n    w.onmessage = function (msg) {\r\n      var obj = JSON.parse(msg.data);\r\n      var eventType = obj.e,\r\n          eventTime = obj.E,\r\n          symbol = obj.s,\r\n          tick = obj.k;\r\n      var startTime = tick.t,\r\n          closeTime = tick.T,\r\n          firstTradeId = tick.f,\r\n          lastTradeId = tick.L,\r\n          open = tick.o,\r\n          high = tick.h,\r\n          low = tick.l,\r\n          close = tick.c,\r\n          volume = tick.v,\r\n          trades = tick.n,\r\n          interval = tick.i,\r\n          isFinal = tick.x,\r\n          quoteVolume = tick.q,\r\n          buyVolume = tick.V,\r\n          quoteBuyVolume = tick.Q;\r\n      cb(transform ? {\r\n        eventType: eventType,\r\n        eventTime: eventTime,\r\n        symbol: symbol,\r\n        startTime: startTime,\r\n        closeTime: closeTime,\r\n        firstTradeId: firstTradeId,\r\n        lastTradeId: lastTradeId,\r\n        open: open,\r\n        high: high,\r\n        low: low,\r\n        close: close,\r\n        volume: volume,\r\n        trades: trades,\r\n        interval: interval,\r\n        isFinal: isFinal,\r\n        quoteVolume: quoteVolume,\r\n        buyVolume: buyVolume,\r\n        quoteBuyVolume: quoteBuyVolume\r\n      } : obj);\r\n    };\r\n\r\n    return w;\r\n  });\r\n  return function (options) {\r\n    return cache.forEach(function (w) {\r\n      return w.close(1000, 'Close handle was called', _objectSpread({\r\n        keepClosed: true\r\n      }, options));\r\n    });\r\n  };\r\n};\r\n\r\nvar miniTickerTransform = function miniTickerTransform(m) {\r\n  return {\r\n    eventType: m.e,\r\n    eventTime: m.E,\r\n    symbol: m.s,\r\n    curDayClose: m.c,\r\n    open: m.o,\r\n    high: m.h,\r\n    low: m.l,\r\n    volume: m.v,\r\n    volumeQuote: m.q\r\n  };\r\n};\r\n\r\nvar tickerTransform = function tickerTransform(m) {\r\n  return {\r\n    eventType: m.e,\r\n    eventTime: m.E,\r\n    symbol: m.s,\r\n    priceChange: m.p,\r\n    priceChangePercent: m.P,\r\n    weightedAvg: m.w,\r\n    prevDayClose: m.x,\r\n    curDayClose: m.c,\r\n    closeTradeQuantity: m.Q,\r\n    bestBid: m.b,\r\n    bestBidQnt: m.B,\r\n    bestAsk: m.a,\r\n    bestAskQnt: m.A,\r\n    open: m.o,\r\n    high: m.h,\r\n    low: m.l,\r\n    volume: m.v,\r\n    volumeQuote: m.q,\r\n    openTime: m.O,\r\n    closeTime: m.C,\r\n    firstTradeId: m.F,\r\n    lastTradeId: m.L,\r\n    totalTrades: m.n\r\n  };\r\n};\r\n\r\nvar futuresTickerTransform = function futuresTickerTransform(m) {\r\n  return {\r\n    eventType: m.e,\r\n    eventTime: m.E,\r\n    symbol: m.s,\r\n    priceChange: m.p,\r\n    priceChangePercent: m.P,\r\n    weightedAvg: m.w,\r\n    curDayClose: m.c,\r\n    closeTradeQuantity: m.Q,\r\n    open: m.o,\r\n    high: m.h,\r\n    low: m.l,\r\n    volume: m.v,\r\n    volumeQuote: m.q,\r\n    openTime: m.O,\r\n    closeTime: m.C,\r\n    firstTradeId: m.F,\r\n    lastTradeId: m.L,\r\n    totalTrades: m.n\r\n  };\r\n};\r\n\r\nvar ticker = function ticker(payload, cb) {\r\n  var transform = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\r\n  var variator = arguments.length > 3 ? arguments[3] : undefined;\r\n  var cache = (Array.isArray(payload) ? payload : [payload]).map(function (symbol) {\r\n    var w = (0, _openWebsocket.default)(\"\".concat(variator === 'futures' ? endpoints.futures : endpoints.base, \"/\").concat(symbol.toLowerCase(), \"@ticker\"));\r\n\r\n    w.onmessage = function (msg) {\r\n      var obj = JSON.parse(msg.data);\r\n      cb(transform ? variator === 'futures' ? futuresTickerTransform(obj) : tickerTransform(obj) : obj);\r\n    };\r\n\r\n    return w;\r\n  });\r\n  return function (options) {\r\n    return cache.forEach(function (w) {\r\n      return w.close(1000, 'Close handle was called', _objectSpread({\r\n        keepClosed: true\r\n      }, options));\r\n    });\r\n  };\r\n};\r\n\r\nvar allTickers = function allTickers(cb) {\r\n  var transform = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\r\n  var variator = arguments.length > 2 ? arguments[2] : undefined;\r\n  var w = new _openWebsocket.default(\"\".concat(variator === 'futures' ? endpoints.futures : endpoints.base, \"/!ticker@arr\"));\r\n\r\n  w.onmessage = function (msg) {\r\n    var arr = JSON.parse(msg.data);\r\n    cb(transform ? variator === 'futures' ? arr.map(function (m) {\r\n      return futuresTickerTransform(m);\r\n    }) : arr.map(function (m) {\r\n      return tickerTransform(m);\r\n    }) : arr);\r\n  };\r\n\r\n  return function (options) {\r\n    return w.close(1000, 'Close handle was called', _objectSpread({\r\n      keepClosed: true\r\n    }, options));\r\n  };\r\n};\r\n\r\nvar miniTicker = function miniTicker(payload, cb) {\r\n  var transform = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\r\n  var cache = (Array.isArray(payload) ? payload : [payload]).map(function (symbol) {\r\n    var w = (0, _openWebsocket.default)(\"\".concat(endpoints.base, \"/\").concat(symbol.toLowerCase(), \"@miniTicker\"));\r\n\r\n    w.onmessage = function (msg) {\r\n      var obj = JSON.parse(msg.data);\r\n      cb(transform ? miniTickerTransform(obj) : obj);\r\n    };\r\n\r\n    return w;\r\n  });\r\n  return function (options) {\r\n    return cache.forEach(function (w) {\r\n      return w.close(1000, 'Close handle was called', _objectSpread({\r\n        keepClosed: true\r\n      }, options));\r\n    });\r\n  };\r\n};\r\n\r\nvar allMiniTicker = function allMiniTicker(payload, cb) {\r\n  var transform = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\r\n  var cache = (Array.isArray(payload) ? payload : [payload]).map(function (symbol) {\r\n    var w = (0, _openWebsocket.default)(\"\".concat(endpoints.base, \"/!miniTicker@arr\"));\r\n\r\n    w.onmessage = function (msg) {\r\n      var arr = JSON.parse(msg.data);\r\n      cb(transform ? arr.map(function (m) {\r\n        return miniTickerTransform(m);\r\n      }) : arr);\r\n    };\r\n\r\n    return w;\r\n  });\r\n  return function (options) {\r\n    return cache.forEach(function (w) {\r\n      return w.close(1000, 'Close handle was called', _objectSpread({\r\n        keepClosed: true\r\n      }, options));\r\n    });\r\n  };\r\n};\r\n\r\nvar customSubStream = function customSubStream(payload, cb, variator) {\r\n  var cache = (Array.isArray(payload) ? payload : [payload]).map(function (sub) {\r\n    var w = (0, _openWebsocket.default)(\"\".concat(variator === 'futures' ? endpoints.futures : endpoints.base, \"/\").concat(sub));\r\n\r\n    w.onmessage = function (msg) {\r\n      var data = JSON.parse(msg.data);\r\n      cb(data);\r\n    };\r\n\r\n    return w;\r\n  });\r\n  return function (options) {\r\n    return cache.forEach(function (w) {\r\n      return w.close(1000, 'Close handle was called', _objectSpread({\r\n        keepClosed: true\r\n      }, options));\r\n    });\r\n  };\r\n};\r\n\r\nvar aggTradesTransform = function aggTradesTransform(m) {\r\n  return {\r\n    eventType: m.e,\r\n    eventTime: m.E,\r\n    timestamp: m.T,\r\n    symbol: m.s,\r\n    price: m.p,\r\n    quantity: m.q,\r\n    isBuyerMaker: m.m,\r\n    wasBestPrice: m.M,\r\n    aggId: m.a,\r\n    firstId: m.f,\r\n    lastId: m.l\r\n  };\r\n};\r\n\r\nvar futuresAggTradesTransform = function futuresAggTradesTransform(m) {\r\n  return {\r\n    eventType: m.e,\r\n    eventTime: m.E,\r\n    symbol: m.s,\r\n    aggId: m.a,\r\n    price: m.p,\r\n    quantity: m.q,\r\n    firstId: m.f,\r\n    lastId: m.l,\r\n    timestamp: m.T,\r\n    isBuyerMaker: m.m\r\n  };\r\n};\r\n\r\nvar aggTrades = function aggTrades(payload, cb) {\r\n  var transform = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\r\n  var variator = arguments.length > 3 ? arguments[3] : undefined;\r\n  var cache = (Array.isArray(payload) ? payload : [payload]).map(function (symbol) {\r\n    var w = (0, _openWebsocket.default)(\"\".concat(variator === 'futures' ? endpoints.futures : endpoints.base, \"/\").concat(symbol.toLowerCase(), \"@aggTrade\"));\r\n\r\n    w.onmessage = function (msg) {\r\n      var obj = JSON.parse(msg.data);\r\n      cb(transform ? variator === 'futures' ? futuresAggTradesTransform(obj) : aggTradesTransform(obj) : obj);\r\n    };\r\n\r\n    return w;\r\n  });\r\n  return function (options) {\r\n    return cache.forEach(function (w) {\r\n      return w.close(1000, 'Close handle was called', _objectSpread({\r\n        keepClosed: true\r\n      }, options));\r\n    });\r\n  };\r\n};\r\n\r\nvar futuresLiqsTransform = function futuresLiqsTransform(m) {\r\n  return {\r\n    symbol: m.s,\r\n    price: m.p,\r\n    origQty: m.q,\r\n    lastFilledQty: m.l,\r\n    accumulatedQty: m.z,\r\n    averagePrice: m.ap,\r\n    status: m.X,\r\n    timeInForce: m.f,\r\n    type: m.o,\r\n    side: m.S,\r\n    time: m.T\r\n  };\r\n};\r\n\r\nvar futuresLiquidations = function futuresLiquidations(payload, cb) {\r\n  var transform = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\r\n  var cache = (Array.isArray(payload) ? payload : [payload]).map(function (symbol) {\r\n    var w = (0, _openWebsocket.default)(\"\".concat(endpoints.futures, \"/\").concat(symbol.toLowerCase(), \"@forceOrder\"));\r\n\r\n    w.onmessage = function (msg) {\r\n      var obj = JSON.parse(msg.data);\r\n      cb(transform ? futuresLiqsTransform(obj.o) : obj);\r\n    };\r\n\r\n    return w;\r\n  });\r\n  return function (options) {\r\n    return cache.forEach(function (w) {\r\n      return w.close(1000, 'Close handle was called', _objectSpread({\r\n        keepClosed: true\r\n      }, options));\r\n    });\r\n  };\r\n};\r\n\r\nvar futuresAllLiquidations = function futuresAllLiquidations(cb) {\r\n  var transform = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\r\n  var w = new _openWebsocket.default(\"\".concat(endpoints.futures, \"/!forceOrder@arr\"));\r\n\r\n  w.onmessage = function (msg) {\r\n    var obj = JSON.parse(msg.data);\r\n    cb(transform ? futuresLiqsTransform(obj.o) : obj);\r\n  };\r\n\r\n  return function (options) {\r\n    return w.close(1000, 'Close handle was called', _objectSpread({\r\n      keepClosed: true\r\n    }, options));\r\n  };\r\n};\r\n\r\nvar tradesTransform = function tradesTransform(m) {\r\n  return {\r\n    eventType: m.e,\r\n    eventTime: m.E,\r\n    tradeTime: m.T,\r\n    symbol: m.s,\r\n    price: m.p,\r\n    quantity: m.q,\r\n    isBuyerMaker: m.m,\r\n    maker: m.M,\r\n    tradeId: m.t,\r\n    buyerOrderId: m.b,\r\n    sellerOrderId: m.a\r\n  };\r\n};\r\n\r\nvar trades = function trades(payload, cb) {\r\n  var transform = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\r\n  var cache = (Array.isArray(payload) ? payload : [payload]).map(function (symbol) {\r\n    var w = (0, _openWebsocket.default)(\"\".concat(endpoints.base, \"/\").concat(symbol.toLowerCase(), \"@trade\"));\r\n\r\n    w.onmessage = function (msg) {\r\n      var obj = JSON.parse(msg.data);\r\n      cb(transform ? tradesTransform(obj) : obj);\r\n    };\r\n\r\n    return w;\r\n  });\r\n  return function (options) {\r\n    return cache.forEach(function (w) {\r\n      return w.close(1000, 'Close handle was called', _objectSpread({\r\n        keepClosed: true\r\n      }, options));\r\n    });\r\n  };\r\n};\r\n\r\nvar userTransforms = {\r\n  // https://github.com/binance-exchange/binance-official-api-docs/blob/master/user-data-stream.md#balance-update\r\n  balanceUpdate: function balanceUpdate(m) {\r\n    return {\r\n      asset: m.a,\r\n      balanceDelta: m.d,\r\n      clearTime: m.T,\r\n      eventTime: m.E,\r\n      eventType: 'balanceUpdate'\r\n    };\r\n  },\r\n  // https://github.com/binance-exchange/binance-official-api-docs/blob/master/user-data-stream.md#account-update\r\n  outboundAccountInfo: function outboundAccountInfo(m) {\r\n    return {\r\n      eventType: 'account',\r\n      eventTime: m.E,\r\n      makerCommissionRate: m.m,\r\n      takerCommissionRate: m.t,\r\n      buyerCommissionRate: m.b,\r\n      sellerCommissionRate: m.s,\r\n      canTrade: m.T,\r\n      canWithdraw: m.W,\r\n      canDeposit: m.D,\r\n      lastAccountUpdate: m.u,\r\n      balances: m.B.reduce(function (out, cur) {\r\n        out[cur.a] = {\r\n          available: cur.f,\r\n          locked: cur.l\r\n        };\r\n        return out;\r\n      }, {})\r\n    };\r\n  },\r\n  // https://github.com/binance-exchange/binance-official-api-docs/blob/master/user-data-stream.md#account-update\r\n  outboundAccountPosition: function outboundAccountPosition(m) {\r\n    return {\r\n      balances: m.B.map(function (_ref2) {\r\n        var a = _ref2.a,\r\n            f = _ref2.f,\r\n            l = _ref2.l;\r\n        return {\r\n          asset: a,\r\n          free: f,\r\n          locked: l\r\n        };\r\n      }),\r\n      eventTime: m.E,\r\n      eventType: 'outboundAccountPosition',\r\n      lastAccountUpdate: m.u\r\n    };\r\n  },\r\n  // https://github.com/binance-exchange/binance-official-api-docs/blob/master/user-data-stream.md#order-update\r\n  executionReport: function executionReport(m) {\r\n    return {\r\n      eventType: 'executionReport',\r\n      eventTime: m.E,\r\n      symbol: m.s,\r\n      newClientOrderId: m.c,\r\n      originalClientOrderId: m.C,\r\n      side: m.S,\r\n      orderType: m.o,\r\n      timeInForce: m.f,\r\n      quantity: m.q,\r\n      price: m.p,\r\n      executionType: m.x,\r\n      stopPrice: m.P,\r\n      icebergQuantity: m.F,\r\n      orderStatus: m.X,\r\n      orderRejectReason: m.r,\r\n      orderId: m.i,\r\n      orderTime: m.T,\r\n      lastTradeQuantity: m.l,\r\n      totalTradeQuantity: m.z,\r\n      priceLastTrade: m.L,\r\n      commission: m.n,\r\n      commissionAsset: m.N,\r\n      tradeId: m.t,\r\n      isOrderWorking: m.w,\r\n      isBuyerMaker: m.m,\r\n      creationTime: m.O,\r\n      totalQuoteTradeQuantity: m.Z,\r\n      orderListId: m.g,\r\n      quoteOrderQuantity: m.Q,\r\n      lastQuoteTransacted: m.Y\r\n    };\r\n  }\r\n};\r\nvar futuresUserTransforms = {\r\n  // https://binance-docs.github.io/apidocs/futures/en/#event-margin-call\r\n  MARGIN_CALL: function MARGIN_CALL(m) {\r\n    return {\r\n      eventTime: m.E,\r\n      crossWalletBalance: m.cw,\r\n      eventType: 'MARGIN_CALL',\r\n      positions: m.p.reduce(function (out, cur) {\r\n        out[cur.a] = {\r\n          symbol: cur.s,\r\n          positionSide: cur.ps,\r\n          positionAmount: cur.pa,\r\n          marginType: cur.mt,\r\n          isolatedWallet: cur.iw,\r\n          markPrice: cur.mp,\r\n          unrealizedPnL: cur.up,\r\n          maintenanceMarginRequired: cur.mm\r\n        };\r\n        return out;\r\n      }, {})\r\n    };\r\n  },\r\n  // https://binance-docs.github.io/apidocs/futures/en/#event-balance-and-position-update\r\n  ACCOUNT_UPDATE: function ACCOUNT_UPDATE(m) {\r\n    return {\r\n      eventTime: m.E,\r\n      transactionTime: m.T,\r\n      eventType: 'ACCOUNT_UPDATE',\r\n      eventReasonType: m.a.m,\r\n      balances: m.a.B.map(function (b) {\r\n        return {\r\n          asset: b.a,\r\n          walletBalance: b.wb,\r\n          crossWalletBalance: b.cw,\r\n          balanceChange: b.bc\r\n        };\r\n      }),\r\n      positions: m.a.P.map(function (p) {\r\n        return {\r\n          symbol: p.s,\r\n          positionAmount: p.pa,\r\n          entryPrice: p.ep,\r\n          accumulatedRealized: p.cr,\r\n          unrealizedPnL: p.up,\r\n          marginType: p.mt,\r\n          isolatedWallet: p.iw,\r\n          positionSide: p.ps\r\n        };\r\n      })\r\n    };\r\n  },\r\n  // https://binance-docs.github.io/apidocs/futures/en/#event-order-update\r\n  ORDER_TRADE_UPDATE: function ORDER_TRADE_UPDATE(m) {\r\n    return {\r\n      eventType: 'ORDER_TRADE_UPDATE',\r\n      eventTime: m.E,\r\n      transactionTime: m.T,\r\n      symbol: m.o.s,\r\n      clientOrderId: m.o.c,\r\n      side: m.o.S,\r\n      orderType: m.o.o,\r\n      timeInForce: m.o.f,\r\n      quantity: m.o.q,\r\n      price: m.o.p,\r\n      averagePrice: m.o.ap,\r\n      stopPrice: m.o.sp,\r\n      executionType: m.o.x,\r\n      orderStatus: m.o.X,\r\n      orderId: m.o.i,\r\n      lastTradeQuantity: m.o.l,\r\n      totalTradeQuantity: m.o.z,\r\n      priceLastTrade: m.o.L,\r\n      commissionAsset: m.o.N,\r\n      commission: m.o.n,\r\n      orderTime: m.o.T,\r\n      tradeId: m.o.t,\r\n      bidsNotional: m.o.b,\r\n      asksNotional: m.o.a,\r\n      isMaker: m.o.m,\r\n      isReduceOnly: m.o.R,\r\n      workingType: m.o.wt,\r\n      originalOrderType: m.o.ot,\r\n      positionSide: m.o.ps,\r\n      closePosition: m.o.cp,\r\n      activationPrice: m.o.AP,\r\n      callbackRate: m.o.cr,\r\n      realizedProfit: m.o.rp\r\n    };\r\n  }\r\n};\r\n\r\nvar userEventHandler = function userEventHandler(cb) {\r\n  var transform = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\r\n  var variator = arguments.length > 2 ? arguments[2] : undefined;\r\n  return function (msg) {\r\n    var _JSON$parse = JSON.parse(msg.data),\r\n        type = _JSON$parse.e,\r\n        rest = _objectWithoutProperties(_JSON$parse, [\"e\"]);\r\n\r\n    cb(variator === 'futures' ? transform && futuresUserTransforms[type] ? futuresUserTransforms[type](rest) : _objectSpread({\r\n      type: type\r\n    }, rest) : transform && userTransforms[type] ? userTransforms[type](rest) : _objectSpread({\r\n      type: type\r\n    }, rest));\r\n  };\r\n};\r\n\r\nexports.userEventHandler = userEventHandler;\r\nvar STREAM_METHODS = ['get', 'keep', 'close'];\r\n\r\nvar capitalize = function capitalize(str, check) {\r\n  return check ? \"\".concat(str[0].toUpperCase()).concat(str.slice(1)) : str;\r\n};\r\n\r\nvar getStreamMethods = function getStreamMethods(opts) {\r\n  var variator = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\r\n  var methods = (0, _httpClient.default)(opts);\r\n  return STREAM_METHODS.reduce(function (acc, key) {\r\n    return [].concat(_toConsumableArray(acc), [methods[\"\".concat(variator).concat(capitalize(\"\".concat(key, \"DataStream\"), !!variator))]]);\r\n  }, []);\r\n};\r\n\r\nvar keepStreamAlive = function keepStreamAlive(method, listenKey) {\r\n  return method({\r\n    listenKey: listenKey\r\n  });\r\n};\r\n\r\nexports.keepStreamAlive = keepStreamAlive;\r\n\r\nvar user = function user(opts, variator) {\r\n  return function (cb, transform) {\r\n    var _getStreamMethods = getStreamMethods(opts, variator),\r\n        _getStreamMethods2 = _slicedToArray(_getStreamMethods, 3),\r\n        getDataStream = _getStreamMethods2[0],\r\n        keepDataStream = _getStreamMethods2[1],\r\n        closeDataStream = _getStreamMethods2[2];\r\n\r\n    var currentListenKey = null;\r\n    var int = null;\r\n    var w = null;\r\n\r\n    var keepAlive = function keepAlive(isReconnecting) {\r\n      if (currentListenKey) {\r\n        keepStreamAlive(keepDataStream, currentListenKey).catch(function () {\r\n          closeStream({}, true);\r\n\r\n          if (isReconnecting) {\r\n            setTimeout(function () {\r\n              return makeStream(true);\r\n            }, 30e3);\r\n          } else {\r\n            makeStream(true);\r\n          }\r\n        });\r\n      }\r\n    };\r\n\r\n    var closeStream = function closeStream(options, catchErrors) {\r\n      if (currentListenKey) {\r\n        clearInterval(int);\r\n        var p = closeDataStream({\r\n          listenKey: currentListenKey\r\n        });\r\n\r\n        if (catchErrors) {\r\n          p.catch(function (f) {\r\n            return f;\r\n          });\r\n        }\r\n\r\n        w.close(1000, 'Close handle was called', _objectSpread({\r\n          keepClosed: true\r\n        }, options));\r\n        currentListenKey = null;\r\n      }\r\n    };\r\n\r\n    var makeStream = function makeStream(isReconnecting) {\r\n      return getDataStream().then(function (_ref3) {\r\n        var listenKey = _ref3.listenKey;\r\n        w = (0, _openWebsocket.default)(\"\".concat(variator === 'futures' ? endpoints.futures : endpoints.base, \"/\").concat(listenKey));\r\n\r\n        w.onmessage = function (msg) {\r\n          return userEventHandler(cb, transform, variator)(msg);\r\n        };\r\n\r\n        currentListenKey = listenKey;\r\n        int = setInterval(function () {\r\n          return keepAlive(false);\r\n        }, 50e3);\r\n        keepAlive(true);\r\n        return function (options) {\r\n          return closeStream(options);\r\n        };\r\n      }).catch(function (err) {\r\n        if (isReconnecting) {\r\n          setTimeout(function () {\r\n            return makeStream(true);\r\n          }, 30e3);\r\n        } else {\r\n          throw err;\r\n        }\r\n      });\r\n    };\r\n\r\n    return makeStream(false);\r\n  };\r\n};\r\n\r\nvar _default = function _default(opts) {\r\n  if (opts && opts.wsBase) {\r\n    endpoints.base = opts.wsBase;\r\n  }\r\n\r\n  if (opts && opts.wsFutures) {\r\n    endpoints.futures = opts.wsFutures;\r\n  }\r\n\r\n  return {\r\n    depth: depth,\r\n    partialDepth: partialDepth,\r\n    candles: candles,\r\n    trades: trades,\r\n    aggTrades: aggTrades,\r\n    ticker: ticker,\r\n    allTickers: allTickers,\r\n    miniTicker: miniTicker,\r\n    allMiniTicker: allMiniTicker,\r\n    customSubStream: customSubStream,\r\n    user: user(opts),\r\n    marginUser: user(opts, 'margin'),\r\n    futuresDepth: function futuresDepth(payload, cb, transform) {\r\n      return depth(payload, cb, transform, 'futures');\r\n    },\r\n    futuresPartialDepth: function futuresPartialDepth(payload, cb, transform) {\r\n      return partialDepth(payload, cb, transform, 'futures');\r\n    },\r\n    futuresCandles: function futuresCandles(payload, interval, cb, transform) {\r\n      return candles(payload, interval, cb, transform, 'futures');\r\n    },\r\n    futuresTicker: function futuresTicker(payload, cb, transform) {\r\n      return ticker(payload, cb, transform, 'futures');\r\n    },\r\n    futuresAllTickers: function futuresAllTickers(cb, transform) {\r\n      return allTickers(cb, transform, 'futures');\r\n    },\r\n    futuresAggTrades: function futuresAggTrades(payload, cb, transform) {\r\n      return aggTrades(payload, cb, transform, 'futures');\r\n    },\r\n    futuresLiquidations: futuresLiquidations,\r\n    futuresAllLiquidations: futuresAllLiquidations,\r\n    futuresUser: user(opts, 'futures'),\r\n    futuresCustomSubStream: function futuresCustomSubStream(payload, cb) {\r\n      return customSubStream(payload, cb, 'futures');\r\n    }\r\n  };\r\n};\r\n\r\nexports.default = _default;"]},"metadata":{},"sourceType":"script"}